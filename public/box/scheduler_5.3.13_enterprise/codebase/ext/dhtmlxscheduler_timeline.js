/*

@license
dhtmlxScheduler v.5.3.13 Professional

This software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.

(c) XB Software Ltd.

*/
Scheduler.plugin(function(e){e._temp_matrix_scope=function(){function t(e,a){if(a=a||[],e.children)for(var n=0;n<e.children.length;n++)a.push(e.children[n].key),t(e.children[n],a);return a}function a(e,t){var a=t.order[e];return void 0===a&&(a="$_"+e),a}function n(e,t){if(t[e.key]=e,e.children)for(var a=0;a<e.children.length;a++)n(e.children[a],t)}function i(e){for(var t={},a=e.y_unit_original||e.y_unit,i=0;i<a.length;i++)n(a[i],t);return t}function r(t,n){function r(e,t,a,n){e[t]||(e[t]=[])
;for(var i=a;i<=n;i++)e[t][i]||(e[t][i]=[]),e[t][i].push(h)}for(var o=[],_=0;_<n.y_unit.length;_++)o[_]=[];var d;o[d]||(o[d]=[]);var s=i(n),l="tree"==n.render;l&&(o.$tree={});for(var c=n.y_property,_=0;_<t.length;_++){var h=t[_],u=h[c];d=a(u,n);var g=e._get_date_index(n,h.start_date),v=e._get_date_index(n,h.end_date);h.end_date.valueOf()==n._trace_x[v].valueOf()&&(v-=1),o[d]||(o[d]=[]),r(o,d,g,v);var f=s[u];if(l&&f&&f.$parent)for(var m={};f.$parent;){
if(m[f.key])throw new Error("Invalid sections tree. Section `{key:'"+f.key+"', label:'"+f.label+"'}` has the same key as one of its parents. Make sure all sections have unique keys");m[f.key]=!0;var p=s[f.$parent];r(o.$tree,p.key,g,v),f=p}}return o}function o(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",
t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var a=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return a==n&&(n=t.clientWidth),document.body.removeChild(t),a-n}function _(t){return e._helpers.formatDate(t)}function d(t,a){var n=t.querySelector(".dhx_timeline_data_wrapper");return a.scrollable||(n=e.$container.querySelector(".dhx_cal_data")),n}function s(e){return e.querySelector(".dhx_timeline_label_wrapper")}function l(){
return e.$container.querySelector(".dhx_cal_data .dhx_timeline_label_col")}function c(t,a,n,i){function r(e){if(e=e||window.event,!e.shiftKey){var t=e.deltaY||e.detail||-e.wheelDelta;t=t<0?-100:100,_.scrollTop+=t,e.preventDefault&&e.preventDefault()}}a._is_ev_creating=!1;var _=d(t,a),c=e._els.dhx_cal_header[0],h=s(t);if(h&&(h.addEventListener?"onwheel"in document?h.addEventListener("wheel",r):"onmousewheel"in document&&h.addEventListener("mousewheel",r):h.attachEvent("onmousewheel",r),
!h.$eventsAttached)){h.$eventsAttached=!0;var u={pageX:0,pageY:0};h.addEventListener("touchstart",function(e){var t=e;e.touches&&(t=e.touches[0]),u={pageX:t.pageX,pageY:t.pageY}}),h.addEventListener("touchmove",function(e){var t=e;e.touches&&(t=e.touches[0]);var a=u.pageY-t.pageY;u={pageX:t.pageX,pageY:t.pageY},a&&(_.scrollTop+=a),e&&e.preventDefault&&e.preventDefault()})}var g;if(_.onscroll=function(r){
var s=d(t,a),h=s.scrollTop,u=a.scrollHelper.getScrollValue(s),v=e._timeline_smart_render.getViewPort(a.scrollHelper,0,u,h),f=l();if(a.scrollable&&(f.style.top=-h+"px"),!1!==a.smart_rendering){if((u!==a._x_scroll||a._is_ev_creating)&&(a.second_scale?e._timeline_smart_render.updateHeader(a,v,c.children[1]):e._timeline_smart_render.updateHeader(a,v,c.children[0])),e.config.rtl){
var m=+e.$container.querySelector(".dhx_timeline_label_wrapper").style.height.replace("px",""),p=a._section_height[a.y_unit.length]+a._label_rows[a._label_rows.length-1].top;a.scrollHelper.getMode()==a.scrollHelper.modes.minMax&&(p>m||"tree"==a.render)?c.style.right=-1-u-o()+"px":c.style.right=-1-u+"px",c.style.left="unset"}else c.style.left=-1-u+"px";(a._options_changed||h!==a._y_scroll||a._is_ev_creating)&&e._timeline_smart_render.updateLabels(a,v,f),a._is_ev_creating=!1,
e._timeline_smart_render.updateGridCols(a,v),e._timeline_smart_render.updateGridRows(a,v);var y=!1;"cell"!=a.render&&(window.requestAnimationFrame?(y=!0,g&&cancelAnimationFrame(g),g=requestAnimationFrame(function(){a.name===e.getState().mode&&(e._timeline_smart_render.updateEvents(a,v),g=0,a.callEvent("onScroll",[a.scrollHelper.getScrollValue(_),_.scrollTop]))})):e._timeline_smart_render.updateEvents(a,v));var b=0;a._scales={};var x
;x="cell"===a.render?s.querySelectorAll(".dhx_timeline_data_col .dhx_timeline_data_row"):s.querySelectorAll(".dhx_timeline_data_col .dhx_matrix_line");for(var w=0,k=x.length;w<k;w++){var D=x[w].getAttribute("data-section-id"),E=a.order[D];n[E]=i[E].height,a._scales[D]=x[w]}for(var w=0,k=n.length;w<k;w++)b+=n[w];e.$container.querySelector(".dhx_timeline_data_col").style.height=b+"px"
;var S=s.scrollTop,N=a.scrollHelper.getScrollValue(s),M=a._summ-e.$container.querySelector(".dhx_cal_data").offsetWidth+a.dx+a.custom_scroll_width;e._timeline_save_scroll_pos(a,S,N,M),y||a.callEvent("onScroll",[N,S]),a._is_new_view=!1}},!_.$eventsAttached){_.$eventsAttached=!0;var v={pageX:0,pageY:0};_.addEventListener("touchstart",function(e){var t=e;e.touches&&(t=e.touches[0]),v={pageX:t.pageX,pageY:t.pageY}}),_.addEventListener("touchmove",function(t){var n=t;t.touches&&(n=t.touches[0])
;var i=l(),r=v.pageX-n.pageX,o=v.pageY-n.pageY;if(v={pageX:n.pageX,pageY:n.pageY},(r||o)&&!e.getState().drag_id){var d=Math.abs(r),s=Math.abs(o),c=Math.sqrt(r*r+o*o),h=d/c,u=s/c;h<.42?r=0:u<.42&&(o=0),a.scrollHelper.setScrollValue(_,a.scrollHelper.getScrollValue(_)+r),_.scrollTop+=o,a.scrollable&&o&&(i.style.top=-_.scrollTop+"px")}return t&&t.preventDefault&&t.preventDefault(),!1})}a.scroll_position&&a._is_new_view?a.scrollTo(a.scroll_position):e._timeline_set_scroll_pos(t,a),
a._is_ev_creating=!0}function h(e,t){if(e.closest)return e.closest(t);if(e.matches||e.msMatchesSelector||e.webkitMatchesSelector){var a=e;if(!document.documentElement.contains(a))return null;do{if((a.matches||a.msMatchesSelector||a.webkitMatchesSelector).call(a,t))return a;a=a.parentElement||a.parentNode}while(null!==a&&1===a.nodeType);return null}return window.console.error("Your browser is not supported"),null}function u(t,a){var n=e.matrix[e._mode],i={},r={},o=a
;for(i.x=t.touches?t.touches[0].pageX:t.pageX,i.y=t.touches?t.touches[0].pageY:t.pageY,r.left=o.offsetLeft+n.dx,r.top=o.offsetTop;o;)r.left+=o.offsetLeft,r.top+=o.offsetTop,o=o.offsetParent;return{x:i.x-r.left,y:i.y-r.top}}function g(t){M&&clearInterval(M),e._schedulerOuter=e.$container.querySelector(".dhx_timeline_data_wrapper");var a={pageX:t.touches?t.touches[0].pageX:t.pageX,pageY:t.touches?t.touches[0].pageY:t.pageY};M=setInterval(function(){v(a)},N)}function v(t){
if(!e.getState().drag_id)return clearInterval(M),void(A=null);var a=e.matrix[e._mode];if(a){var n=e._schedulerOuter,i=u(t,n),r=n.offsetWidth-a.dx,o=n.offsetHeight,_=i.x,d=i.y,s=a.autoscroll||{};e._merge(s,{range_x:200,range_y:100,speed_x:20,speed_y:10});var l=f(_,r,A?A.x:0,s.range_x);a.scrollable||(l=0);var c=f(d,o,A?A.y:0,s.range_y);!c&&!l||A||(A={x:_,y:d},l=0,c=0),l*=s.speed_x,c*=s.speed_y,l&&c&&(Math.abs(l/5)>Math.abs(c)?c=0:Math.abs(c/5)>Math.abs(l)&&(l=0)),l||c?(A.started=!0,
m(l,c)):clearInterval(M)}}function f(e,t,a,n){return e<n&&(!A||A.started||e<a)?-1:t-e<n&&(!A||A.started||e>a)?1:0}function m(t,a){var n=e._schedulerOuter;a&&(n.scrollTop+=a),t&&(n.scrollLeft+=t)}var p=function(){return function(){function e(){var e=document.createElement("div");e.style.cssText="direction: rtl;overflow: auto;width:100px;height: 100px;position:absolute;top: -100500px;left: -100500px;";var t=document.createElement("div");return t.style.cssText="width: 100500px;height: 1px;",
e.appendChild(t),e}function t(){var t=_.minMax,a=e();return document.body.appendChild(a),a.scrollLeft>0?t=_.minMax:(a.scrollLeft=-50,t=-50===a.scrollLeft?_.nMaxMin:_.maxMin),document.body.removeChild(a),t}function a(e,t){var a=r();return a===_.nMaxMin?e?-e:0:a===_.minMax?t-e:e}function n(e){var t=getComputedStyle(e).direction;if(t&&"ltr"!==t){var n=e.scrollWidth-e.offsetWidth;return a(e.scrollLeft,n)}return e.scrollLeft}function i(e,t){var n=getComputedStyle(e).direction;if(n&&"ltr"!==n){
var i=e.scrollWidth-e.offsetWidth,r=a(t,i);e.scrollLeft=r}else e.scrollLeft=t}function r(){return o||(o=t()),o}var o,_={minMax:"[0;max]",maxMin:"[max;0]",nMaxMin:"[-max;0]"};return{modes:_,getMode:r,normalizeValue:a,getScrollValue:n,setScrollValue:i}}}();e.matrix={},e._merge=function(e,t){for(var a in t)void 0===e[a]&&(e[a]=t[a])},e.createTimelineView=function(a){function n(a,n,i){var r=e._timeline_smart_render.getPreparedEvents(i),o=i.order[a],_=i.y_unit[o];if(!_)return[];var d=[a];n&&t(_,d)
;for(var s=[],l=0;l<d.length;l++){var o=i.order[d[l]];if(void 0!==o&&r[o])s=s.concat(r[o]);else if(r.undefined)for(var c=0;c<r.undefined.length;c++){var h=r.undefined[c];h[i.y_property]==d[l]&&s.push(h)}}return s}function i(t,a,n,i){var r=e._timeline_smart_render.getPreparedEvents(i),o=[],_=[],d=i.order[t],s=i.y_unit[d];if(!s)return[];var l=e._get_date_index(i,a);return r.$matrix?(o=r.$matrix[d][l]||[],n&&r.$matrix.$tree&&r.$matrix.$tree[s.key]&&(_=r.$matrix.$tree[s.key][l]||[]),
o.concat(_)):r[d]||[]}function r(t,a,n){for(var i=e.date[n.name+"_start"](new Date(t)),r=0,o=i,_=n.x_step,d=n.x_unit;o<a;)r++,o=e.date.add(o,_,d);return r}e._skin_init(),e._merge(a,{scrollHelper:p(),column_width:100,autoscroll:{range_x:200,range_y:100,speed_x:20,speed_y:10},_is_new_view:!0,_section_autowidth:!0,_x_scroll:0,_y_scroll:0,_h_cols:{},_label_rows:[],section_autoheight:!0,name:"matrix",x:"time",y:"time",x_step:1,x_unit:"hour",y_unit:"day",y_step:1,x_start:0,x_size:24,y_start:0,
y_size:7,render:"cell",dx:200,dy:50,event_dy:e.xy.bar_height-5,event_min_dy:e.xy.bar_height-5,resize_events:!0,fit_events:!0,show_unassigned:!1,second_scale:!1,round_position:!1,_logic:function(t,a,n){var i={};return e.checkEvent("onBeforeSectionRender")&&(i=e.callEvent("onBeforeSectionRender",[t,a,n])),i}}),a._original_x_start=a.x_start,"day"!=a.x_unit&&(a.first_hour=a.last_hour=0),a._start_correction=a.first_hour?60*a.first_hour*60*1e3:0,
a._end_correction=a.last_hour?60*(24-a.last_hour)*60*1e3:0,e.checkEvent("onTimelineCreated")&&e.callEvent("onTimelineCreated",[a]),dhtmlxEventable(a);var _=e.render_data;e.render_data=function(t,n){if(this._mode!=a.name)return _.apply(this,arguments);if(n&&!a.show_unassigned&&"cell"!=a.render)for(var i=0;i<t.length;i++)this.clear_event(t[i]),this.render_timeline_event.call(this.matrix[this._mode],t[i],!0);else e._renderMatrix.call(a,!0,!0)},e.matrix[a.name]=a,
e.templates[a.name+"_cell_value"]=function(e){return e?e.length:""},e.templates[a.name+"_cell_class"]=function(e){return""},e.templates[a.name+"_scalex_class"]=function(e){return""},e.templates[a.name+"_second_scalex_class"]=function(e){return""},e.templates[a.name+"_row_class"]=function(e,t){return t.folder_events_available&&e.children?"folder":""},e.templates[a.name+"_scaley_class"]=function(e,t,a){return""},e.templates[a.name+"_scale_label"]=function(e,t,a){return t},
e.templates[a.name+"_tooltip"]=function(e,t,a){return a.text},e.templates[a.name+"_date"]=function(t,a){return t.getDay()==a.getDay()&&a-t<864e5||+t==+e.date.date_part(new Date(a))||+e.date.add(t,1,"day")==+a&&0===a.getHours()&&0===a.getMinutes()?e.templates.day_date(t):t.getDay()!=a.getDay()&&a-t<864e5?e.templates.day_date(t)+" &ndash; "+e.templates.day_date(a):e.templates.week_date(t,a)},e.templates[a.name+"_scale_date"]=e.date.date_to_str(a.x_date||e.config.hour_date),
e.templates[a.name+"_second_scale_date"]=e.date.date_to_str(a.second_scale&&a.second_scale.x_date?a.second_scale.x_date:e.config.hour_date),e.date["add_"+a.name+"_private"]=function(t,n){var i=n,r=a.x_unit;if("minute"==a.x_unit||"hour"==a.x_unit){var o=i;"hour"==a.x_unit&&(o*=60),o%1440||(i=o/1440,r="day")}return e.date.add(t,i,r)},e.date["add_"+a.name]=function(t,n,i){var r=e.date["add_"+a.name+"_private"](t,(a.x_length||a.x_size)*a.x_step*n);if("minute"==a.x_unit||"hour"==a.x_unit){
var o=a.x_length||a.x_size,_="hour"==a.x_unit?60*a.x_step:a.x_step;if(_*o%1440)if(+e.date.date_part(new Date(t))==+e.date.date_part(new Date(r)))a.x_start+=n*o;else{var d=1440/(o*_)-1,s=Math.round(d*o);a.x_start=n>0?a.x_start-s:s+a.x_start}}return r},e.date[a.name+"_start"]=function(t){var n=e.date[a.x_unit+"_start"]||e.date.day_start,i=n.call(e.date,t),r=i.getTimezoneOffset();i=e.date.add(i,a.x_step*a.x_start,a.x_unit);var o=i.getTimezoneOffset();return r!=o&&i.setTime(i.getTime()+6e4*(o-r)),i
},a._smartRenderingEnabled=function(){var t=null;(this.scrollable||this.smart_rendering)&&(t=e._timeline_smart_render.getViewPort(this.scrollHelper,this._sch_height));var a=!!t;return!!(this.scrollable?!1!==this.smart_rendering&&!!a:!!this.smart_rendering&&a)},a.scrollTo=e.bind(function(t){if(t){var a;a=t.date?t.date:t.left?t.left:t;var n=-1;t.section?n=this.posFromSection(t.section):t.top&&(n=t.top);var i;if(i="number"==typeof a?a:this.posFromDate(a),e.config.rtl){
var r=+e.$container.querySelector(".dhx_timeline_label_wrapper").style.height.replace("px",""),_=this._section_height[this.y_unit.length]+this._label_rows[this._label_rows.length-1].top;this.scrollHelper.getMode()==this.scrollHelper.modes.minMax&&(_>r||"tree"==this.render)&&(i-=o())}var d=e.$container.querySelector(".dhx_timeline_data_wrapper");this.scrollable||(d=e.$container.querySelector(".dhx_cal_data")),this.scrollable&&this.scrollHelper.setScrollValue(d,i),n>0&&(d.scrollTop=n)}},a),
a.getScrollPosition=e.bind(function(){return{left:this._x_scroll||0,top:this._y_scroll||0}},a),a.posFromDate=e.bind(function(t){return e._timeline_getX({start_date:t},!1,this)-1},a),a.dateFromPos=function(t){return e._timeline_drag_date(a,t)},a.sectionFromPos=function(t){var n={y:t};return e._resolve_timeline_section(a,n),n.section},a.resolvePosition=function(e){var t={date:null,section:null};return e.left&&(t.date=a.dateFromPos(e.left)),e.top&&(t.section=a.sectionFromPos(e.top)),t},
a.posFromSection=e.bind(function(e){var t=this.order[e];if(void 0===t)return-1;var a=0;for(var n in this.order)this.order[n]<t&&(a+=this._section_height[n]);return a},a),a.selectEvents=e.bind(function(e){var t=e.section,a=e.date,r=e.selectNested;return a?i(t,a,r,this):t?n(t,r,this):void 0},a),a.setRange=e.bind(function(t,a){var n=e.date[this.name+"_start"](new Date(t)),i=r(t,a,this);this.x_size=i,e.setCurrentView(n,this.name)},a),e.callEvent("onOptionsLoad",[a]),e[a.name+"_view"]=function(t){
t?e._set_timeline_dates(a):e._renderMatrix.apply(a,arguments)};var d=new Date;e.date.add(d,a.x_step,a.x_unit).valueOf(),d.valueOf();e["mouse_"+a.name]=function(t){var n=this._drag_event;if(this._drag_id&&(n=this.getEvent(this._drag_id)),a.scrollable&&!t.converted){if(t.converted=1,t.x+=-a.dx+a._x_scroll,e.config.rtl){var i=+e.$container.querySelector(".dhx_timeline_label_wrapper").style.height.replace("px",""),r=a._section_height[a.y_unit.length]+a._label_rows[a._label_rows.length-1].top
;t.x+=e.xy.scale_width,a.scrollHelper.getMode()==a.scrollHelper.modes.minMax&&(r>i||"tree"==a.render)&&(t.x+=o())}t.y+=a._y_scroll}else e.config.rtl?t.x-=a.dx-e.xy.scale_width:t.x-=a.dx;var _=e._timeline_drag_date(a,t.x);if(t.x=0,t.force_redraw=!0,t.custom=!0,"move"==this._drag_mode&&this._drag_id&&this._drag_event){var n=this.getEvent(this._drag_id),d=this._drag_event;if(t._ignores=this._ignores_detected||a._start_correction||a._end_correction,
void 0===d._move_delta&&(d._move_delta=(n.start_date-_)/6e4,this.config.preserve_length&&t._ignores&&(d._move_delta=this._get_real_event_length(n.start_date,_,a),d._event_length=this._get_real_event_length(n.start_date,n.end_date,a))),this.config.preserve_length&&t._ignores){var s=(d._event_length,this._get_fictional_event_length(_,d._move_delta,a,!0));_=new Date(_-s)}else _=e.date.add(_,d._move_delta,"minute")}
if("resize"==this._drag_mode&&n&&(this.config.timeline_swap_resize&&this._drag_id&&(this._drag_from_start&&+_>+n.end_date?this._drag_from_start=!1:!this._drag_from_start&&+_<+n.start_date&&(this._drag_from_start=!0)),t.resize_from_start=this._drag_from_start,!this.config.timeline_swap_resize&&this._drag_id&&this._drag_from_start&&+_>=+e.date.add(n.end_date,-e.config.time_step,"minute")&&(_=e.date.add(n.end_date,-e.config.time_step,"minute"))),a.round_position)switch(this._drag_mode){case"move":
this.config.preserve_length||(_=e._timeline_get_rounded_date.call(a,_,!1),"day"==a.x_unit&&(t.custom=!1));break;case"resize":this._drag_event&&(null!==this._drag_event._resize_from_start&&void 0!==this._drag_event._resize_from_start||(this._drag_event._resize_from_start=t.resize_from_start),t.resize_from_start=this._drag_event._resize_from_start,_=e._timeline_get_rounded_date.call(a,_,!this._drag_event._resize_from_start))}this._resolve_timeline_section(a,t),
t.section&&this._update_timeline_section({pos:t,event:this.getEvent(this._drag_id),view:a}),t.y=Math.round((this._correct_shift(_,1)-this._min_date)/(6e4*this.config.time_step)),t.shift=this.config.time_step,a.round_position&&"new-size"==this._drag_mode&&_<=this._drag_start&&(t.shift=e.date.add(this._drag_start,a.x_step,a.x_unit)-this._drag_start);var l=this._is_pos_changed(this._drag_pos,t);return this._drag_pos&&l&&(this._drag_event._dhx_changed=!0),
l||this._drag_pos.has_moved||(t.force_redraw=!1),t}},e._prepare_timeline_events=function(t){var a=[];if("cell"==t.render)a=e._timeline_trace_events.call(t);else{for(var n=e.get_visible_events(),i=t.order,r=0;r<n.length;r++){var o=n[r],_=o[t.y_property],d=t.order[_];t.y_unit[d];if(t.show_unassigned&&!_){for(var s in i)if(i.hasOwnProperty(s)){d=i[s],a[d]||(a[d]=[]);var l=e._lame_copy({},o);l[t.y_property]=s,a[d].push(l);break}}else a[d]||(a[d]=[]),a[d].push(o)}
a.$matrix=e._timeline_trace_events.call(t)}return a},e._populate_timeline_rendered=function(t){e._rendered=[];for(var a=t.querySelectorAll("div[event_id]"),n=0;n<a.length;n++)e._rendered.push(a[n])},e._get_timeline_event_height=function(e,t){var a=e[t.y_property],n=t.event_dy;return"full"==t.event_dy&&(n=t.section_autoheight?t._section_height[a]-6:t.dy-3),t.resize_events&&(n=Math.max(Math.floor(n/(e._count||1)),t.event_min_dy)),n},e._get_timeline_event_y=function(t,a){
var n=t||0,i=2+n*a+(n?2*n:0);return e.config.cascade_event_display&&(i=2+n*e.config.cascade_event_margin+(n?2*n:0)),i},e.render_timeline_event=function(t,a){var n=t[this.y_property];if(!n)return"";var i=t._sorder,r=e._timeline_getX(t,!1,this),o=e._timeline_getX(t,!0,this),_=e._get_timeline_event_height(t,this),d=_-2;t._inner||"full"!=this.event_dy||(d=(d+2)*(t._count-i)-2),d+=3;var s=e._get_timeline_event_y(t._sorder,_),l=_+s+2
;(!this._events_height[n]||this._events_height[n]<l)&&(this._events_height[n]=l);var c=e.templates.event_class(t.start_date,t.end_date,t);c="dhx_cal_event_line "+(c||""),e.getState().select_id==t.id&&(c+=" dhx_cal_event_selected"),t._no_drag_move&&(c+=" no_drag_move")
;var h=t.color?"background:"+t.color+";":"",u=t.textColor?"color:"+t.textColor+";":"",g=e.templates.event_bar_text(t.start_date,t.end_date,t),v="<div "+e._waiAria.eventBarAttrString(t)+" event_id='"+t.id+"' class='"+c+"' style='"+h+u+"position:absolute; top:"+s+"px; height: "+d+"px; "+(e.config.rtl?"right:":"left:")+r+"px; width:"+Math.max(0,o-r)+"px;"+(t._text_style||"")+"'>";if(e.config.drag_resize&&!e.config.readonly){
var f="dhx_event_resize",m=d+1,p="<div class='"+f+" "+f+"_start' style='height: "+m+"px;'></div>",y="<div class='"+f+" "+f+"_end' style='height: "+m+"px;'></div>";v+=(t._no_resize_start?"":p)+(t._no_resize_end?"":y)}if(v+=g+"</div>",!a)return v;var b=document.createElement("div");b.innerHTML=v;var x=this._scales[n];x&&(e._rendered.push(b.firstChild),x.appendChild(b.firstChild))};var y=function(e){return String(e).replace(/'/g,"&apos;").replace(/"/g,"&quot;")},b=function(e){
return String(e).replace(/'/g,"\\'").replace(/"/g,'\\"')};e._timeline_trace_events=function(){return r(e.get_visible_events(),this)},e._timeline_getX=function(t,a,n){var i=0,r=n._step,o=n.round_position,_=0,d=a?t.end_date:t.start_date;d.valueOf()>e._max_date.valueOf()&&(d=e._max_date);var s=d-e._min_date_timeline;if(s>0){var l=e._get_date_index(n,d);e._ignores[l]&&(o=!0);for(var c=0;c<l;c++)i+=e._cols[c];var h=e._timeline_get_rounded_date.apply(n,[d,!1]);o?+d>+h&&a&&(_=e._cols[l]):(s=d-h,
n.first_hour||n.last_hour?(s-=n._start_correction,s<0&&(s=0),(_=Math.round(s/r))>e._cols[l]&&(_=e._cols[l])):_=Math.round(s/r))}e._border_box_events();return i+=a?0===s||o?_-2:_:_+1},e._timeline_get_rounded_date=function(t,a){var n=e._get_date_index(this,t),i=this._trace_x[n];return a&&+t!=+this._trace_x[n]&&(i=this._trace_x[n+1]?this._trace_x[n+1]:e.date.add(this._trace_x[n],this.x_step,this.x_unit)),new Date(i)},e._timeline_skip_ignored=function(t){
if(e._ignores_detected)for(var a,n,i,r,o=0;o<t.length;o++){for(r=t[o],i=!1,a=e._get_date_index(this,r.start_date),n=e._get_date_index(this,r.end_date);a<n;){if(!e._ignores[a]){i=!0;break}a++}i||a!=n||e._ignores[n]||+r.end_date>+this._trace_x[n]&&(i=!0),i||(t.splice(o,1),o--)}},e._timeline_calculate_event_positions=function(t){if(t&&"cell"!=this.render){e._timeline_skip_ignored.call(this,t),t.sort(this.sort||function(e,t){
return e.start_date.valueOf()==t.start_date.valueOf()?e.id>t.id?1:-1:e.start_date>t.start_date?1:-1});for(var a=[],n=t.length,i=-1,r=null,o=0;o<n;o++){var _=t[o];_._inner=!1;var d=this.round_position?e._timeline_get_rounded_date.apply(this,[_.start_date,!1]):_.start_date;for(this.round_position?e._timeline_get_rounded_date.apply(this,[_.end_date,!0]):_.end_date;a.length;){if(!(a[a.length-1].end_date.valueOf()<=d.valueOf()))break;a.splice(a.length-1,1)}for(var s=!1,l=0;l<a.length;l++){var c=a[l]
;if(c.end_date.valueOf()<=d.valueOf()){s=!0,_._sorder=c._sorder,a.splice(l,1),_._inner=!0;break}}if(a.length&&(a[a.length-1]._inner=!0),!s)if(a.length)if(a.length<=a[a.length-1]._sorder){if(a[a.length-1]._sorder)for(var h=0;h<a.length;h++){for(var u=!1,g=0;g<a.length;g++)if(a[g]._sorder==h){u=!0;break}if(!u){_._sorder=h;break}}else _._sorder=0;_._inner=!0}else{for(var v=a[0]._sorder,f=1;f<a.length;f++)a[f]._sorder>v&&(v=a[f]._sorder);_._sorder=v+1,i<_._sorder&&(i=_._sorder,r=_),_._inner=!1
}else _._sorder=0;a.push(_),a.length>(a.max_count||0)?(a.max_count=a.length,_._count=a.length):_._count=_._count?_._count:1}for(var m=0;m<t.length;m++)t[m]._count=a.max_count,e._register_copy&&e._register_copy(t[m]);(r||t[0])&&e.render_timeline_event.call(this,r||t[0],!1)}},e._timeline_get_events_html=function(t){var a="";if(t&&"cell"!=this.render)for(var n=0;n<t.length;n++)a+=e.render_timeline_event.call(this,t[n],!1);return a},e._timeline_update_events_html=function(t){var a=""
;if(t&&"cell"!=this.render){var n=e.getView(),i={},r=function(e,t){return e+"_"+t};t.forEach(function(e){i[r(e.id,e[n.y_property])]=!0}),e._rendered.forEach(function(e){if(e.parentNode){var t=e.parentNode.getAttribute("data-section-id");i[r(e.getAttribute("event_id"),t)]&&e.parentNode.removeChild(e)}});for(var o=0;o<t.length;o++)a+=e.render_timeline_event.call(this,t[o],!1)}return a},e._timeline_get_block_stats=function(t,a){var n={};return a._sch_height=t.offsetHeight,
n.style_data_wrapper=(e.config.rtl?"padding-right:":"padding-left:")+a.dx+"px;",n.style_label_wrapper="width: "+a.dx+"px;",a.scrollable?(n.style_data_wrapper+="height:"+(a._sch_height-1)+"px;",void 0===a.html_scroll_width&&(a.html_scroll_width=o()),a._section_autowidth?a.custom_scroll_width=0:a.custom_scroll_width=a.html_scroll_width,n.style_label_wrapper+="height:"+(a._sch_height-1-a.custom_scroll_width)+"px;"):(n.style_data_wrapper+="height:"+(a._sch_height-1)+"px;",
n.style_label_wrapper+="height:"+(a._sch_height-1)+"px;overflow:visible;"),n},e._timeline_get_cur_row_stats=function(t,a){var n=t._logic(t.render,t.y_unit[a],t);if(e._merge(n,{height:t.dy}),t.section_autoheight){var i=t.scrollable?t._sch_height-e.xy.scroll_width:t._sch_height;t.y_unit.length*n.height<i&&(n.height=Math.max(n.height,Math.floor((i-1)/t.y_unit.length)))}return t._section_height[t.y_unit[a].key]=n.height,
n.td_className||(n.td_className="dhx_matrix_scell"+(e.templates[t.name+"_scaley_class"](t.y_unit[a].key,t.y_unit[a].label,t.y_unit[a])?" "+e.templates[t.name+"_scaley_class"](t.y_unit[a].key,t.y_unit[a].label,t.y_unit[a]):"")),n.td_content||(n.td_content=e.templates[t.name+"_scale_label"](t.y_unit[a].key,t.y_unit[a].label,t.y_unit[a])),e._merge(n,{tr_className:"",style_height:"height:"+n.height+"px;",style_width:"width:"+t.dx+"px;",summ_width:"width:"+t._summ+"px;",table_className:""}),n},
e._timeline_get_fit_events_stats=function(e,t,a){if(e.fit_events){var n=e._events_height[e.y_unit[t].key]||0;a.height=n>a.height?n:a.height,a.style_height="height:"+a.height+"px;",a.style_line_height="line-height:"+(a.height-1)+"px;",e._section_height[e.y_unit[t].key]=a.height}return a.style_height="height:"+a.height+"px;",a.style_line_height="line-height:"+(a.height-1)+"px;",e._section_height[e.y_unit[t].key]=a.height,a},e._timeline_set_scroll_pos=function(e,t){
var a=e.querySelector(".dhx_timeline_data_wrapper");a.scrollTop=t._y_scroll||0,t.scrollHelper.setScrollValue(a,t._x_scroll||0),t.scrollHelper.getMode()!=t.scrollHelper.modes.maxMin&&a.scrollLeft==t._summ-a.offsetWidth+t.dx&&(a.scrollLeft+=o())},e._timeline_save_scroll_pos=function(e,t,a,n){e._y_scroll=t||0,e._x_scroll=a||0},e._timeline_get_html_for_cell_data_row=function(e,t,a,n,i){var r="";return i.template&&(r+=" "+(i.template(i.section,i.view)||"")),
"<div class='dhx_timeline_data_row"+r+"' data-section-id='"+y(n)+"' data-section-index='"+e+"' style='"+t.summ_width+t.style_height+" position:absolute; top:"+a+"px;'>"},e._timeline_get_html_for_cell_ignores=function(e){return'<div class="dhx_matrix_cell dhx_timeline_data_cell" style="'+e.style_height+e.style_line_height+';display:none"></div>'},e._timeline_get_html_for_cell=function(t,a,n,i,r,o){var d=n._trace_x[t],s=n.y_unit[a],l=e._cols[t],c=_(d),h=e.templates[n.name+"_cell_value"](i,d,s)
;return"<div data-col-id='"+t+"' data-col-date='"+c+"' class='dhx_matrix_cell dhx_timeline_data_cell "+e.templates[n.name+"_cell_class"](i,d,s)+"' style='width:"+l+"px;"+r.style_height+r.style_line_height+(e.config.rtl?" right:":"  left:")+o+"px;'><div style='width:auto'>"+h+"</div></div>"},e._timeline_get_html_for_bar_matrix_line=function(e,t,a,n){
return"<div style='"+t.summ_width+" "+t.style_height+" position:absolute; top:"+a+"px;' data-section-id='"+y(n)+"' data-section-index='"+e+"' class='dhx_matrix_line'>"},e._timeline_get_html_for_bar_data_row=function(e,t){var a=e.table_className;return t.template&&(a+=" "+(t.template(t.section,t.view)||"")),"<div class='dhx_timeline_data_row "+a+"' style='"+e.summ_width+" "+e.style_height+"' >"},e._timeline_get_html_for_bar_ignores=function(){return""},
e._timeline_get_html_for_bar=function(t,a,n,i,r,o){var d=_(n._trace_x[t]),s=n.y_unit[a],l="";n.cell_template&&(l=e.templates[n.name+"_cell_value"](i,n._trace_x[t],s,o));var c="line-height:"+n._section_height[s.key]+"px;"
;return"<div class='dhx_matrix_cell dhx_timeline_data_cell "+e.templates[n.name+"_cell_class"](i,n._trace_x[t],s,o)+"' style='width:"+e._cols[t]+"px; "+(e.config.rtl?"right:":"left:")+r+"px;'  data-col-id='"+t+"' data-col-date='"+d+"' ><div style='width:auto; height:100%;position:relative;"+c+"'>"+l+"</div></div>"},e._timeline_render_scale_header=function(t,a){var n=e.$container.querySelector(".dhx_timeline_scale_header");if(n&&n.parentNode.removeChild(n),a){n=document.createElement("div")
;var i="dhx_timeline_scale_header";t.second_scale&&(i+=" dhx_timeline_second_scale");var r=e.xy.scale_height;n.className=i,n.style.cssText=["width:"+(t.dx-1)+"px","height:"+r+"px","line-height:"+r+"px","top:"+(e.xy.nav_height+2)+"px",e.config.rtl?"right:0":"left:0"].join(";"),n.innerHTML=e.locale.labels[t.name+"_scale_header"]||"",e.$container.appendChild(n)}},e._timeline_y_scale=function(t){
var a=e._timeline_get_block_stats(t,this),n=this.scrollable?" dhx_timeline_scrollable_data":"",i="<div class='dhx_timeline_table_wrapper'>",r="<div class='dhx_timeline_label_wrapper' style='"+a.style_label_wrapper+"'><div class='dhx_timeline_label_col'>",o="<div class='dhx_timeline_data_wrapper"+n+"' style='"+a.style_data_wrapper+"'><div class='dhx_timeline_data_col'>";e._load_mode&&e._loa